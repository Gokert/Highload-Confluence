# Проектирование высоконагруженного пространства для командной работы

Курсовая работа в рамках 3-го семестра программы по Веб-разработке ОЦ VK x МГТУ им. Н.Э. Баумана (ex. "Технопарк") по дисциплине "Проектирование высоконагруженных сервисов"

#### Автор - [Андрей Мышляев](https://park.vk.company/profile/a.myshliaev/ "Страница на портале VK x МГТУ")
#### Задание - [Методические указания](https://github.com/init/highload/blob/main/homework_architecture.md)

#### Содержание:
1. [Тема, функционал и аудитория](#1)
2. [Расчет нагрузки](#2)


## Часть 1. Тема и целевая аудитория <a name="1"></a>

### Тема курсовой работы - **"Проектирование сервиса для командной работы"**
Confluence — это удобное рабочее пространство для удаленных команд, в котором участники могут хранить знания и сотрудничать друг с другом. В приложении Confluence Cloud можно легко записывать возникшие идеи, создавать и редактировать страницы и совместно работать с командой практически на любом устройстве.


### Ключевой функционал сервиса
- Поиск по статьям
- Совместный просмотр/редактирование/создание контента (страницы с текстом, таблицами)
- Установка доступов для пользователей
- Комментирование каждой страницы

### Целевая аудитория
- Весь мир
- 25 млн пользователей в месяц (MAU) [^1]
- 1 млн пользователей в день (DAU) [^1]

## Часть 2. Расчет нагрузки <a name="2"></a>

#### Средний размер хранилища пользователя по типам:

| Хранимые данные   | Оценочный размер на пользователя         |
|-------------------|------------------------------------------|
| Аватары              | `2 Мб`                            |
| Данные профиля              | `1 Кб`                     |


**Таким образом всего:** `2 Мб 1Кб` на пользователя при вводе персональных данных.

#### Рассчитаем RPS:

|Действие пользователя |Количество / день|
| ------------- |-------------|
|Версионирование| 5 млн |
|Поиск, полнотекстовый| 10 млн |
|Линковка| 50 млн |
|Создание доков | 5 млн |
|Редактирование, совмествное| 4 млрд |
|Нотификации| 7 млн |

- Допустим пользователь создает 5 новых версий документа, тогда в день в среднем будет 5 млн таких действий.
- Допустим пользователь 10 раз делает полнотекстовый поиск , тогда в день в среднем будет 10 млн таких действий.
- Допустим пользователь создает 5 новых документов, тогда в день в среднем будет 5 млн таких действий.
- Допустим пользователь редактирует в среднем 4 раза документ, тогда в день будет 4 млн таких действий.
- Допустим пользователь получает в среднем 7 оповещений, тогда в день в среднем будет 7 млн таких событий.


#### Рассчитаем объем трафика и необходимое хранилище:

| Хранимые данные   | Стартовый размер (Пб)  | Увеличение (Пб/год)    |
|-------------------|------------------------|------------------|
| Документы              | `0.015`            |        `5,209`       |
| Данные пользователя              | `1,86`  |          `647,3`         |

#### Предположим, что размер одного документа в среднем 3 Кб, тогда при условии, что в день от одного юзера поступает 5 новых документов.
- Память для документов: 5 * 3 Кб * 1 млн * 365 =  5,209 Пб.
- Память дял новых юзеров: 1 млн * (2 Мб + 1 Кб) * 365 = 0.365 Тб

### Список источников:
1. Статистика Atlassian: https://www.atlassian.com/ru/customers/the-telegraph

2. Статистика Hypestat: https://hypestat.com/info/confluence.atlassian.com

3. Данные по макс размеру: https://confluence.atlassian.com/confkb/how-to-detect-5mb-of-text-on-page-858576591.html

